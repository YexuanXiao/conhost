diff --git a/c:\Users\xyx\Documents\OpenConsole\new/src/runtime/session.cpp b/c:\Users\xyx\Documents\OpenConsole\new/src/runtime/session.cpp
--- a/c:\Users\xyx\Documents\OpenConsole\new/src/runtime/session.cpp
+++ b/c:\Users\xyx\Documents\OpenConsole\new/src/runtime/session.cpp
@@ -3021,3 +3021,3 @@
                 {
-                    auto delegation_target = resolve_console_handoff_clsid();
+                    auto delegation_target = resolve_console_handoff_target();
                     if (!delegation_target)
@@ -3025,8 +3025,8 @@
                          logger.log(
-                             logging::LogLevel::warning,
-                             L"Default-terminal delegation probe failed; falling back to classic window. context='{}', error={}",
-                             delegation_target.error().context,
-                             delegation_target.error().win32_error);
-                     }
-                    else if (delegation_target->has_value())
+                              logging::LogLevel::warning,
+                              L"Default-terminal delegation probe failed; falling back to classic window. context='{}', error={}",
+                              delegation_target.error().context,
+                              delegation_target.error().win32_error);
+                      }
+                    else if (delegation_target->kind == ConsoleHandoffKind::custom)
                     {
